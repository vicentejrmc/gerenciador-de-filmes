import{a as z,b as H}from"./chunk-MZH3AHZ7.js";import{b as G}from"./chunk-ZGI6Y3AA.js";import{Aa as N,B as o,Ca as R,E as j,L as C,N as h,O as V,P as S,Q as B,R as l,S as c,T as s,U as f,V as M,W as g,X as b,_ as d,aa as T,d as F,f as _,g as k,i as q,ia as A,ja as m,k as w,ka as u,l as D,m as E,r as v,ra as I,s as y,t as x,ta as L}from"./chunk-UV2O3WZ6.js";var O=(t,e)=>({"btn-primary":t,"btn-outline-primary":e}),K=(t,e)=>e.id;function Q(t,e){if(t&1&&(c(0,"div",6),f(1,"app-card-midia",7),s()),t&2){let i=e.$implicit;o(),l("tipoMidia",i.media_type)("midia",i)}}function U(t,e){t&1&&(c(0,"div",4),S(1,Q,2,2,"div",6,K),s()),t&2&&(o(),B(e))}function W(t,e){if(t&1&&(c(0,"div",8),f(1,"app-card-midia",7),s()),t&2){let i=e.$implicit;o(),l("tipoMidia",i.media_type)("midia",i)}}function X(t,e){t&1&&(c(0,"div",4),S(1,W,2,2,"div",8,K),s()),t&2&&(o(),B(e))}function Y(t,e){if(t&1){let i=M();c(0,"div",9)(1,"button",11),g("click",function(){let r=y(i).$implicit,n=b(2);return x(n.goToPage(r))}),d(2),s()()}if(t&2){let i=e.$implicit,a=b();o(),l("ngClass",A(2,O,a.paginaAtual===i,a.paginaAtual!==i)),o(),T(" ",i," ")}}function Z(t,e){if(t&1){let i=M();c(0,"section",5)(1,"div",9)(2,"button",10),g("click",function(){y(i);let r=b();return x(r.goToFirst())}),d(3," In\xEDcio "),s()(),S(4,Y,3,5,"div",9,V),c(6,"div",9)(7,"button",10),g("click",function(){let r=y(i),n=b();return x(n.goToLast(r.totalPaginas))}),d(8," Fim "),s()()()}if(t&2){let i=e;o(2),l("disabled",i.paginaAtual===1),o(2),B(i.paginas),o(3),l("disabled",i.paginaAtual===i.totalPaginas)}}var J=class t{route=v(N);midiaSevice=v(G);router=v(R);paginaSubject$=new F(1);buscar(e){this.router.navigate(["/busca"],{queryParams:{query:e}})}queryParam$=this.route.queryParamMap.pipe(q(e=>e.has("query")),_(e=>e.get("query")));midiasSelecionadas$=k([this.paginaSubject$,this.queryParam$]).pipe(D(([e,i])=>this.midiaSevice.pesquisarMidia(i,e)),w({bufferSize:1,refCount:!0}));filmesEncontrados=this.midiasSelecionadas$.pipe(_(e=>e.results.filter(i=>i.media_type==="filme")),E(e=>console.log(e)));seriesEncontradas=this.midiasSelecionadas$.pipe(_(e=>e.results.filter(i=>i.media_type==="tv")),E(e=>console.log(e)));paginasDisponiveis$=this.midiasSelecionadas$.pipe(_(e=>{let i=Math.max(1,e.total_pages??1),a=Math.max(1,e.page??1),r=6,n=a-Math.floor(r/2);n<1&&(n=1);let p=n+r-1;p>i&&(p=i,n=Math.max(1,p-r+1));let P=[];for(let $=n;$<p;$++)P.push($);return{paginaAtual:a,totalPaginas:i,paginas:P,mostrarInio:n>1,mostrarFim:p<i}}),w({bufferSize:1,refCount:!0}));goToPage(e){this.paginaSubject$.next(e)}goToFirst(){this.paginaSubject$.next(1)}goToLast(e){this.paginaSubject$.next(e)}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=j({type:t,selectors:[["app-busca"]],decls:16,vars:15,consts:[[1,"container","mt-4","text-light"],[3,"buscar"],[1,"border"],[1,"m-3","fw-semibold"],[1,"row","g-2","mt-2"],["id","paginacao",1,"row","justify-content-center","gap-1","mt-2","g-2","align-items-center"],[1,"col-3","col-lg-3","col-xl-2"],[3,"tipoMidia","midia"],[1,"col-4","col-lg-3","col-xl-2"],[1,"col-auto"],[1,"btn","btn-sm","btn-outline-primary","text-light","fw-bold","mb-2",3,"click","disabled"],[1,"btn","btn-sm","rounded-circle","text-light","fw-bold","mb-2",2,"min-width","33px",3,"click","ngClass"]],template:function(i,a){if(i&1&&(c(0,"div",0)(1,"app-barra-busca",1),g("buscar",function(n){return a.buscar(n)}),s(),f(2,"hr",2),c(3,"h5",3),d(4),m(5,"async"),s(),C(6,U,3,0,"div",4),m(7,"async"),f(8,"hr",2),c(9,"h5",3),d(10),m(11,"async"),s(),C(12,X,3,0,"div",4),m(13,"async"),C(14,Z,9,2,"section",5),m(15,"async"),s()),i&2){let r,n,p;o(4),T(' Filmes encontrados para: "',u(5,5,a.queryParam$),'" '),o(2),h((r=u(7,7,a.filmesEncontrados))?6:-1,r),o(4),T(' Series/Tv encontrados para: "',u(11,9,a.queryParam$),'" '),o(2),h((n=u(13,11,a.seriesEncontradas))?12:-1,n),o(2),h((p=u(15,13,a.paginasDisponiveis$))?14:-1,p)}},dependencies:[z,H,I,L],encapsulation:2})};export{J as Busca};
